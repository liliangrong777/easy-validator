"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=function(){function t(){this.type="__required"}return t.prototype.validate=function(t,e){if(""===e)return t.message||"Required"},t}(),e=function(){function t(){this.type="__regexp"}return t.prototype.validate=function(t,e){if(!t.reg.test(e))return t.message||"Invalid"},t}(),r=function(){function t(){this.type="__custom"}return t.prototype.validate=function(t,e){try{t.validator(t,e)}catch(t){return t}},t}(),i=function(){function i(t){if(this.validates=[],this.rules=[],t){if(!Array.isArray(t))throw new Error("Invalid rules. Expected an array.");for(var e=0,r=t;e<r.length;e++){var i=r[e];if(!("required"in i||"reg"in i||"validator"in i||"type"in i))throw new Error("Invalid rule item. Must have a valid structure.")}t.length>0&&(this.add.apply(this,t),this.rules=t)}}return i.getOrCreateStrategy=function(t){var e=i.strategies.get(t);return e||(e=new i.defaultStrategies[t],i.strategies.set(t,e)),e},i.addStrategies=function(){for(var t=this,e=[],r=0;r<arguments.length;r++)e[r]=arguments[r];e.forEach((function(e){t.strategies.set(e.type,e)}))},i.getRuleStrategy=function(t){if(t.required)return i.getOrCreateStrategy("__required");if(t.reg)return i.getOrCreateStrategy("__regexp");if(t.validator)return i.getOrCreateStrategy("__custom");var e=i.strategies.get(t.type);if(e)return e;throw new Error("Invalid rule item")},i.prototype.add=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=0;r<t.length;r++){var a=t[r],n=i.getRuleStrategy(a);this.validates.push(n),this.rules.push(a)}},i.prototype.run=function(t){for(var e="",r=0;r<this.validates.length;r++){var i=this.validates[r],a=this.rules[r],n=i.validate(a,t);if(n){e=n;break}}return e},i.defaultStrategies={__required:t,__regexp:e,__custom:r},i.strategies=new Map,i}();exports.Validator=i;
